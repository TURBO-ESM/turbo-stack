module test_field_checksum_real640d
  use pfunit
  use MOM_coms_infra
  use MOM_test_case
  use iso_fortran_env, only : int64
  implicit none

  @testCase()
  type, extends(MOM_MPI_test_case) :: testcase_broadcast
  end type testcase_broadcast

contains

  @test(npes=[4])
  subroutine field_checksum_real640d(this)
    class (testcase_broadcast), intent(inout) :: this

    real,                parameter :: field             = 0.5
    integer(kind=int64), parameter :: expected_checksum = -36028797018963968
    integer(kind=int64)            :: actual_checksum
    
    actual_checksum = field_chksum(field)

    @assertEqual(expected_checksum, actual_checksum)
  end subroutine field_checksum_real640d

end module test_field_checksum_real640d