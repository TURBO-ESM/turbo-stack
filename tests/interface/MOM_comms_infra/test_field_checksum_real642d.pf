module test_field_checksum_real642d
  use pfunit
  use MOM_coms_infra
  use MOM_test_case
  use iso_fortran_env, only : int64, real64
  implicit none

  @testCase()
  type, extends(MOM_MPI_test_case) :: field_checksum_2d_testcase
  end type field_checksum_2d_testcase

contains

  @test(npes=[4])
  subroutine field_checksum_real642d(this)
    class (field_checksum_2d_testcase), intent(inout) :: this

    real,                allocatable :: field(:,:)
    integer(kind=int64), parameter   :: expected_checksum = -450359962737049600_int64
    integer(kind=int64)              :: actual_checksum

    allocate(field(5,5))
    field = 1.0

    actual_checksum = field_chksum(field)

    @assertEqual(expected_checksum, actual_checksum)

    deallocate(field)
  end subroutine field_checksum_real642d
end module test_field_checksum_real642d
